CREATE DATABASE QuanLyBHMayAnh;
USE QuanLyBHMayAnh;
CREATE TABLE CONGVIEC
(
  MaCV CHAR(5) ,
  TenCV NVARCHAR(50) ,
  MucLuong FLOAT,
  PRIMARY KEY (MaCV)
);
drop table CONGVIEC;
CREATE TABLE LOAIHANG
(
  MaLoai CHAR(10) ,
  TenLoai NVARCHAR(50) ,
  PRIMARY KEY (MaLoai)
);
Drop table LOAIHANG ;

CREATE TABLE DOPHANGIAI
(
  MaDPG CHAR(15) ,
  TenDPG NVARCHAR(50) ,
  PRIMARY KEY (MaDPG)
);
Drop table DOPHANGIAI ;

CREATE TABLE DUNGLUONG
(
  MaDL CHAR(15) ,
  TenDL NVARCHAR(50),
  PRIMARY KEY (MaDL)
);
Drop table DUNGLUONG ;
 
CREATE TABLE HANGSX
(
  MaHangSX CHAR(15) ,
  TenHangSX NVARCHAR(50) ,
  PRIMARY KEY (MaHangSX)
);
Drop table HANGSX ;

CREATE TABLE NUOCSX
(
  MaNuocSX CHAR(15) ,
  TenNuocSX NVARCHAR(50) ,
  PRIMARY KEY (MaNuocSX)
);
Drop table NUOCSX ;

CREATE TABLE MAUSAC
(
  MaMau CHAR(15) ,
  TenMau NVARCHAR(50) ,
  PRIMARY KEY (MaMau)
);
Drop table MAUSAC ;

CREATE TABLE DOIMAY
(
  MaDoi CHAR(15) ,
  TenDoi NVARCHAR(50) ,
  PRIMARY KEY (MaDoi)
);
Drop table DOIMAY ;

CREATE TABLE KHACHHANG
(
  MaKH CHAR(15) NOT NULL,
  TenKH NVARCHAR(50) ,
  DiaChi NVARCHAR(150) ,
  DienThoai NVARCHAR(50) ,
  PRIMARY KEY (MaKH)
);
Drop table KHACHHANG ;

CREATE TABLE NHACUNGCAP
(
  MaNCC CHAR(15) NOT NULL,
  TenNCC NVARCHAR(50) ,
  DiaChi NVARCHAR(150) ,
  DienThoai NVARCHAR(50) ,
  PRIMARY KEY (MaNCC)
);

CREATE TABLE ADMIN
(
  TenDangNhap VARCHAR(100) NOT NULL,
  MatKhau VARCHAR(100) NOT NULL,
);

Drop table NHACUNGCAP ;

CREATE TABLE NHANVIEN
(
  MaNV CHAR(15) NOT NULL,
  TenNV NVARCHAR(50) ,
  GioiTinh NVARCHAR(15) ,
  DienThoai NVARCHAR(50) ,
  DiaChi NVARCHAR(150) ,
  NgaySinh DATE,
  MaCV CHAR(5) ,
  MatKhau VARCHAR(50),
  PRIMARY KEY (MaNV),
  FOREIGN KEY (MaCV) REFERENCES CONGVIEC(MaCV)
);

Drop table NHANVIEN;

CREATE TABLE DANHMUCHANGHOA
(
  MaHH CHAR(15) ,
  TenHH NVARCHAR(150) ,
  SoLuong INT ,
  DonGiaNhap FLOAT,
  DonGiaBan FLOAT ,
  ThoiGianBH INT,
  MaLoai CHAR(10),
  MaDPG CHAR(15),
  MaDL CHAR(15) ,
  MaHangSX CHAR(15),
  MaDoi CHAR(15) ,
  MaNuocSX CHAR(15) ,
  MaMau CHAR(15) ,
  PRIMARY KEY (MaHH),
  FOREIGN KEY (MaLoai) REFERENCES LOAIHANG(MaLoai),
  FOREIGN KEY (MaDPG) REFERENCES DOPHANGIAI(MaDPG),
  FOREIGN KEY (MaDL) REFERENCES DUNGLUONG(MaDL),
  FOREIGN KEY (MaHangSX) REFERENCES HANGSX(MaHangSX),
  FOREIGN KEY (MaDoi) REFERENCES DOIMAY(MaDoi),
  FOREIGN KEY (MaNuocSX) REFERENCES NUOCSX(MaNuocSX),
  FOREIGN KEY (MaMau) REFERENCES MAUSAC(MaMau)
);
Drop Table DANHMUCHANGHOA;
CREATE TABLE HOADONBAN
(
  MaHDB CHAR(15) ,
  NgayBan DATE ,
  TongTien FLOAT,
  MaNV CHAR(15) ,
  MaKH CHAR(15) ,
  PRIMARY KEY (MaHDB),
  FOREIGN KEY (MaNV) REFERENCES NHANVIEN(MaNV),
  FOREIGN KEY (MaKH) REFERENCES KHACHHANG(MaKH)
);

Drop table HOADONBAN ;

CREATE TABLE HOADONNHAP
(
  MaHDN CHAR(15),
  NgayNhap DATE ,
  TongTien FLOAT ,
  MaNCC CHAR(15),
  MaNV CHAR(15),
  PRIMARY KEY (MaHDN),
  FOREIGN KEY (MaNCC) REFERENCES NHACUNGCAP(MaNCC),
  FOREIGN KEY (MaNV) REFERENCES NHANVIEN(MaNV)
);

Drop table HOADONNHAP ;

CREATE TABLE CHITIETHDB
(
  SoLuong INT ,
  GiamGia FLOAT ,
  ThanhTien FLOAT,
  MaHDB CHAR(15) ,
  MaHH CHAR(15) ,
  FOREIGN KEY (MaHDB) REFERENCES HOADONBAN(MaHDB),
  FOREIGN KEY (MaHH) REFERENCES DANHMUCHANGHOA(MaHH)
);

Drop table CHITIETHDB;

CREATE TABLE CHITIETHDN
(
  SoLuong INT ,
  DonGia FLOAT ,
  GiamGia FLOAT ,
  ThanhTien FLOAT ,
  MaHDN CHAR(15) ,
  MaHH CHAR(15) ,
  FOREIGN KEY (MaHDN) REFERENCES HOADONNHAP(MaHDN),
  FOREIGN KEY (MaHH) REFERENCES DANHMUCHANGHOA(MaHH)
);

Drop table CHITIETHDN;

INSERT INTO CONGVIEC (MaCV, TenCV, MucLuong) VALUES 
('CV01', N'Quản lý', 20000000),
('CV02', N'Nhân viên bán hàng', 10000000),
('CV03', N'Kỹ thuật viên', 15000000),
('CV04', N'Nhân viên kho', 10000000);

INSERT INTO LOAIHANG (MaLoai, TenLoai) VALUES 
('LH01', N'Máy ảnh'),
('LH02', N'Ống kính'),
('LH03', N'Máy quay phim'),
('LH04', N'Phụ kiện máy ảnh');

INSERT INTO DOPHANGIAI (MaDPG, TenDPG) VALUES 
('DPG01', '24MP'),
('DPG02', '32MP'),
('DPG03', '48MP');

INSERT INTO DUNGLUONG (MaDL, TenDL) VALUES 
('DL01', '128GB'),
('DL02', '256GB'),
('DL03', '512GB');

INSERT INTO HANGSX (MaHangSX, TenHangSX) VALUES 
('HSX01', 'Canon'),
('HSX02', 'Sony'),
('HSX03', 'Nikon');

INSERT INTO NUOCSX (MaNuocSX, TenNuocSX) VALUES 
('NSX01', N'Nhật Bản'),
('NSX02', N'Mỹ'),
('NSX03', N'Đức');

INSERT INTO MAUSAC (MaMau, TenMau) VALUES 
('M01', N'Đen'),
('M02', N'Trắng'),
('M03', N'Xám');

INSERT INTO DOIMAY (MaDoi, TenDoi) VALUES 
('DM01', 'EOS R5'),
('DM02', 'Alpha 7 IV'),
('DM03', 'D850');


INSERT INTO KHACHHANG (MaKH, TenKH, DiaChi, DienThoai) VALUES 
('KH01', N'Nguyễn Văn Anh', N'Hà Nội', '0901234567'),
('KH02', N'Dương Thị Nhung', N'TP. Hồ Chí Minh', '0912345678'),
('KH03', N'Trần Thị Vy', N'TP. Hồ Chí Minh', '0912345678');

UPDATE KHACHHANG
SET DienThoai = '0987654321'
WHERE MaKH = 'KH03';


INSERT INTO NHACUNGCAP (MaNCC, TenNCC, DiaChi, DienThoai) VALUES 
('NCC01', N'Công ty TNHH Canon Việt Nam', N'Hà Nội', '0241234567'),
('NCC02', N'Sony Việt Nam', N'TP. Hồ Chí Minh', '0281234567');

INSERT INTO ADMIN (TenDangNhap, MatKhau) VALUES 
('admin1', 'password123'),
('admin2', '1234abcd');

INSERT INTO NHANVIEN (MaNV, TenNV, GioiTinh, DienThoai, DiaChi, NgaySinh, MaCV,MatKhau) VALUES 
('NV01',N'Trần Thị Vy',N'Nữ','0328584740',N'Thái Bình','1995-11-17','CV01','123456'),
('NV02', N'Phạm Thị Dung', N'Nữ', '0914567890', N'Hải Phòng', '1995-03-22', 'CV02','NV021234'),
('NV03', N'Lê Văn Hiếu', N'Nam', '0903456789', N'Đà Nẵng', '1990-01-15', 'CV02','NV031234'),
('NV04',N'Trần Quang Phương',N'Nam','0988997562',N'Hải Dương','2000-10-13','CV04','NV041234'),
('NV05',N'Trần Quang Thương',N'Nam','0988997533',N'Bắc Giang','2001-10-3','CV04','NV051234');

INSERT INTO DANHMUCHANGHOA (MaHH, TenHH, SoLuong, DonGiaNhap, DonGiaBan, ThoiGianBH, MaLoai, MaDPG, MaDL, MaHangSX, MaDoi, MaNuocSX, MaMau) VALUES 
('HH01', 'Canon EOS R5', 10, 60000000, 70000000, 12,  'LH01', 'DPG01', 'DL01', 'HSX01', 'DM01', 'NSX01', 'M01'),
('HH02', 'Sony Alpha 7 IV', 8, 50000000, 60000000, 12,  'LH02', 'DPG02', 'DL02', 'HSX02', 'DM02', 'NSX02', 'M02'),
('HH03', 'Nikon Z9', 5, 100000000, 110000000, 24, 'LH01', 'DPG03', 'DL03', 'HSX03', 'DM03', 'NSX03', 'M03'),
('HH04', 'Fujifilm X-T5', 12, 40000000, 45000000, 18, 'LH01', 'DPG02', 'DL02', 'HSX02', 'DM02', 'NSX02', 'M02'),
('HH05', 'Panasonic Lumix S5II', 7, 45000000, 52000000, 18, 'LH01', 'DPG02', 'DL02', 'HSX02', 'DM03', 'NSX01', 'M01'),
('HH06', 'Leica Q2', 3, 150000000, 160000000, 36, 'LH01', 'DPG03', 'DL03', 'HSX03', 'DM03', 'NSX03', 'M03'),
('HH07', 'Olympus OM-D E-M1 Mark III', 10, 30000000, 35000000, 12, 'LH01', 'DPG02', 'DL02', 'HSX01', 'DM02', 'NSX02', 'M02'),
('HH08', 'Pentax K-3 Mark III', 6, 32000000, 36000000, 12, 'LH01', 'DPG03', 'DL03', 'HSX03', 'DM03', 'NSX03', 'M03'),
('HH09', 'Canon EOS R6 Mark II', 15, 50000000, 58000000, 24, 'LH01', 'DPG01', 'DL01', 'HSX01', 'DM01', 'NSX01', 'M01'),
('HH10', 'Sony ZV-E10', 20, 18000000, 20000000, 12, 'LH01', 'DPG02', 'DL02', 'HSX02', 'DM02', 'NSX02', 'M02'),
('HH11', 'DJI Ronin 4D', 2, 160000000, 170000000, 36, 'LH03', 'DPG03', 'DL03', 'HSX03', 'DM03', 'NSX03', 'M03'),
('HH12', 'GoPro Hero 12', 25, 12000000, 14000000, 12, 'LH03', 'DPG02', 'DL01', 'HSX02', 'DM02', 'NSX02', 'M01');

INSERT INTO HOADONBAN (MaHDB, NgayBan, TongTien, MaNV, MaKH) VALUES 
('HDB01', '2024-11-28', 70000000, 'NV01', 'KH01'),
('HDB02', '2024-11-29', 60000000, 'NV02', 'KH02');


INSERT INTO HOADONNHAP (MaHDN, NgayNhap, TongTien, MaNCC, MaNV) VALUES 
('HDN01', '2024-11-15', 600000000, 'NCC01', 'NV01'),
('HDN02', '2024-11-20', 500000000, 'NCC02', 'NV02');

INSERT INTO CHITIETHDB (SoLuong, GiamGia, ThanhTien, MaHDB, MaHH) VALUES 
(1, 0, 70000000, 'HDB01', 'HH01'),
(2, 5, 114000000, 'HDB02', 'HH02');

INSERT INTO CHITIETHDN (SoLuong, DonGia, GiamGia, ThanhTien, maHDN, MaHH) VALUES 
(10, 6000000, 0, 60000000, 'HDN01', 'HH01'),
(8, 5000000, 0, 40000000, 'HDN02', 'HH02');



